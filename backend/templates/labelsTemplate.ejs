<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: sans-serif; margin: 5px; font-size: 8pt; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 5px; width: 100%; }
        .card { 
            border: 1px dashed #777; padding: 4px 6px; page-break-inside: avoid; 
            display: flex; flex-direction: column; justify-content: space-between; 
            aspect-ratio: 2 / 1.1; box-sizing: border-box; position: relative;
        }
        .folio-number { font-size: 14pt; font-weight: bold; text-align: center; line-height: 1.1; margin-bottom: 2px; color: #000; white-space: nowrap; }
        .details { display: flex; justify-content: space-between; align-items: center; font-size: 8.5pt; line-height: 1.2; gap: 4px; }
        .time { font-weight: bold; white-space: nowrap; }
        .shape-persons { display: flex; flex-direction: column; align-items: flex-end; white-space: nowrap; }
        .shape { display: block; text-transform: capitalize; }
        .persons { display: block; font-weight: bold; }
        
        /* Estilo para el marcador 'C' de complemento */
        .complement-marker {
            font-size: 8.5pt; font-weight: bold; color: #333; background-color: #eee;
            border: 1px solid #bbb; border-radius: 50%; width: 16px; height: 16px;
            display: flex; align-items: center; justify-content: center; line-height: 1; margin-bottom: 2px;
        }
    </style>
</head>
<body>
    <h1>Etiquetas del DÃ­a: <%= new Date(fecha).toLocaleDateString('es-ES', { 
        weekday: 'long', 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
    }) %></h1>
    
    <div class="grid">
        <% etiquetas.forEach(etiqueta => { %>
        <div class="card">
            <div class="folio-number"><%= etiqueta.folio %></div>
            <div class="details">
                <span class="time"><%= etiqueta.horaEntrega %></span>
                <span class="shape-persons">
                    <% if (etiqueta.esComplemento) { %>
                        <span class="complement-marker">C</span>
                        <span class="shape">Comp.</span>
                    <% } else { %>
                        <span class="shape"><%= etiqueta.forma %></span>
                    <% } %>
                    <span class="persons"><%= etiqueta.personas %></span>
                </span>
            </div>
        </div>
        <% }); %>
    </div>
</body>
</html>